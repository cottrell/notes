---
layout: post
title: "Marginal Net Outcome"
description: "Calculate the marginal net outcome rate per working day at different work intensities, showing the tax efficiency of working additional days."
excerpt: "Discover how much additional net outcome you get per extra day worked due to progressive taxation and pension contribution limits."
tags: [UK, tax, marginal, efficiency, SIPP, 2025-26]
categories: [vibecoding]
date: 2025-08-06
---

<div style="background: #fff5f5; border-left: 4px solid #e53e3e; padding: 12px; margin: 20px 0; border-radius: 4px;">
    <strong>‚ö†Ô∏è Disclaimer:</strong> <span style="color: #e53e3e;">Calculations not thoroughly verified - could contain errors in tax details.</span>
</div>

<div style="background: #f0f9ff; border: 2px solid #0ea5e9; border-radius: 8px; padding: 20px; margin: 20px 0;">
    <h3 style="margin-top: 0; color: #0ea5e9;">üîë TL;DR</h3>
    <p style="margin-bottom: 0; font-size: 16px; line-height: 1.5;">
        If you can <strong>choose how much you work</strong> and receive gross income at a linear rate, 
        <strong>your marginal return per working day decreases substantially</strong> as you work more due to progressive taxation and pension contribution limits.
        The UK tax system creates significant "efficiency cliffs" where working additional days becomes much less rewarding.
    </p>
</div>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marginal Net Outcome</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            color: #333;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2, h3 {
            color: #2c3e50;
        }

        .calculator-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }

        .input-group {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        label {
            font-weight: 600;
            color: #34495e;
            min-width: 200px;
        }

        input {
            padding: 10px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
            width: 150px;
        }

        input:focus {
            outline: none;
            border-color: #3498db;
        }

        button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.3);
        }

        .chart {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin: 30px 0;
        }

        .chart-wrapper {
            width: 100%;
            height: 500px;
        }

        .examples-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 30px 0;
        }

        .example-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .example-btn {
            background: #e9ecef;
            color: #495057;
            border: 1px solid #ced4da;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .example-btn:hover {
            background: #dee2e6;
            transform: none;
            box-shadow: none;
        }

        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            label {
                min-width: unset;
            }
        }
    </style>
</head>
<body>
    <h1>Marginal Net Outcome</h1>
    
    <p>Channeling <a href="https://taxpolicy.org.uk/about/" target="_blank" style="color: #3498db;">Dan Niedle at Tax Policy Associates</a>, let's understand the tax efficiency of working different intensities.</p>
    
    <div style="background: #f8f9fa; border: 2px solid #3498db; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center;">
        <div style="font-size: 18px; font-weight: bold; color: #2c3e50;">
            Net Income + SIPP Contribution = <span style="color: #3498db;">Net Outcome (NO)</span>
        </div>
        <div style="font-size: 14px; color: #7f8c8d; margin-top: 8px;">
            (treating pension as income since it's money you keep)
        </div>
    </div>
    
    <div style="background: #e8f5e8; border: 2px solid #27ae60; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center;">
        <div style="font-size: 18px; font-weight: bold; color: #2c3e50;">
            Change in NO per Additional Working Day = <span style="color: #27ae60;">Marginal Net Outcome (MNO)</span>
        </div>
        <div style="font-size: 14px; color: #7f8c8d; margin-top: 8px;">
            (how much extra you get for each extra day worked)
        </div>
    </div>
    
    <p>Calculate your marginal net outcome rate per working day at different work intensities. This shows how much additional net outcome you get per extra day worked due to progressive taxation and pension limits.</p>

    <div class="calculator-container">
        <h2>Calculator Settings</h2>
        
        <div class="input-group">
            <label for="grossIncome">Full-Time Gross Annual Salary (¬£):</label>
            <input type="number" id="grossIncome" value="50000" min="0" max="500000" step="1000">
        </div>
        
        <div class="input-group">
            <label for="carryoverSipp">Carry-Over SIPP Allowance (¬£):</label>
            <input type="number" id="carryoverSipp" value="0" min="0" max="180000" step="1000">
        </div>
        
        <button onclick="updateChart()">Calculate Marginal NO Rates</button>
    </div>

    <div class="examples-container">
        <div class="example-buttons">
            <button class="example-btn" onclick="setExample(50000)">¬£50k</button>
            <button class="example-btn" onclick="setExample(80000)">¬£80k</button>
            <button class="example-btn" onclick="setExample(100000)">¬£100k</button>
            <button class="example-btn" onclick="setExample(150000)">¬£150k</button>
            <button class="example-btn" onclick="setExample(200000)">¬£200k</button>
            <button class="example-btn" onclick="setExample(300000)">¬£300k</button>
            <button class="example-btn" onclick="setExample(400000)">¬£400k</button>
            <button class="example-btn" onclick="setExample(500000)">¬£500k</button>
        </div>
    </div>

    <div class="chart">
        <h3>Marginal Net Outcome (NO) Rate per Working Day</h3>
        <div id="efficiencyChart" class="chart-wrapper"></div>
    </div>

    <div id="breakdownTable" class="calculator-container" style="display: none;">
        <h3>Tax Breakdown by Work Intensity</h3>
        <div id="tableContent"></div>
    </div>

    <div class="chart">
        <h3>UK Marginal Tax Rates 2025-26 (Background Info)</h3>
        <div id="marginalTaxChart" class="chart-wrapper"></div>
    </div>

    <script>
        const taxData2025 = {
            incomeTax: {
                personalAllowance: 12570,
                personalAllowanceReductionStart: 100000,
                personalAllowanceReductionRate: 0.5,
                bands: [
                    { min: 12570, max: 50270, rate: 0.20, name: "Basic Rate" },
                    { min: 50270, max: 125140, rate: 0.40, name: "Higher Rate" },
                    { min: 125140, max: Infinity, rate: 0.45, name: "Additional Rate" }
                ]
            },
            nationalInsurance: {
                rates: [
                    { min: 0, max: 12570, rate: 0.00 },
                    { min: 12570, max: 50284, rate: 0.08 },
                    { min: 50284, max: Infinity, rate: 0.02 }
                ]
            },
            pension: {
                annualAllowance: 60000,
                minimumContribution: 3600,
                taperedAllowanceStart: 260000,
                taperedAllowanceMinimum: 10000,
                taperedRate: 0.5
            }
        };

        function calculatePersonalAllowance(grossIncome) {
            if (grossIncome <= taxData2025.incomeTax.personalAllowanceReductionStart) {
                return taxData2025.incomeTax.personalAllowance;
            }
            
            const reduction = (grossIncome - taxData2025.incomeTax.personalAllowanceReductionStart) * 
                             taxData2025.incomeTax.personalAllowanceReductionRate;
            return Math.max(0, taxData2025.incomeTax.personalAllowance - reduction);
        }

        function calculateIncomeTax(grossIncome, pensionContribution = 0) {
            const taxableIncome = Math.max(0, grossIncome - pensionContribution);
            const personalAllowance = calculatePersonalAllowance(taxableIncome);
            const taxableAmount = Math.max(0, taxableIncome - personalAllowance);
            
            let tax = 0;
            for (const band of taxData2025.incomeTax.bands) {
                if (taxableAmount > band.min) {
                    const taxableInBand = Math.min(taxableAmount, band.max) - band.min;
                    tax += taxableInBand * band.rate;
                }
            }
            
            return tax;
        }

        function calculateNationalInsurance(grossIncome, pensionContribution = 0) {
            const niableIncome = Math.max(0, grossIncome - pensionContribution);
            let ni = 0;
            
            for (const band of taxData2025.nationalInsurance.rates) {
                if (niableIncome > band.min) {
                    const niableInBand = Math.min(niableIncome, band.max) - band.min;
                    ni += niableInBand * band.rate;
                }
            }
            
            return ni;
        }

        function calculateMaxPensionContribution(grossIncome, carryoverAllowance = 0) {
            let allowance = taxData2025.pension.annualAllowance + carryoverAllowance;
            
            if (grossIncome > taxData2025.pension.taperedAllowanceStart) {
                const reduction = (grossIncome - taxData2025.pension.taperedAllowanceStart) * 
                                 taxData2025.pension.taperedRate;
                allowance = Math.max(taxData2025.pension.taperedAllowanceMinimum, allowance - reduction);
            }
            
            return Math.min(allowance, Math.max(grossIncome, taxData2025.pension.minimumContribution));
        }

        function calculateTotalTax(grossIncome, pensionContribution = 0) {
            const incomeTax = calculateIncomeTax(grossIncome, pensionContribution);
            const nationalInsurance = calculateNationalInsurance(grossIncome, pensionContribution);
            
            return {
                incomeTax,
                nationalInsurance,
                total: incomeTax + nationalInsurance,
                netIncome: grossIncome - incomeTax - nationalInsurance - pensionContribution
            };
        }

        let efficiencyChart;
        let marginalTaxChart;
        let sharedData = []; // Single source of truth for both chart and table

        function calculateSharedData(fullTimeIncome, carryoverSipp) {
            const workingDaysPerYear = 365 - 104 - 28;
            const data = [];
            
            // First calculate all the basic data points
            const rawData = [];
            for (let i = 0; i <= 20; i++) {
                const daysPerWeek = (i / 20) * 5;
                const percentFullTime = (daysPerWeek / 5) * 100;
                const currentIncome = fullTimeIncome * (daysPerWeek / 5);
                
                // No SIPP scenario
                const noSippCalc = calculateTotalTax(currentIncome, 0);
                
                // Max SIPP scenario
                const maxPension = calculateMaxPensionContribution(currentIncome, carryoverSipp);
                const maxSippCalc = calculateTotalTax(currentIncome, maxPension);
                const maxNet = maxSippCalc.netIncome + maxPension;
                
                // Calculate work days and holidays for this intensity (keep fractional)
                const fullTimeWorkDays = 365 - 104; // 365 days - weekends = 261
                const fullTimeHolidays = 28;
                const actualWorkDays = fullTimeWorkDays * (daysPerWeek / 5);
                const actualHolidays = fullTimeHolidays * (daysPerWeek / 5);
                const netWorkingDays = actualWorkDays - actualHolidays;
                
                rawData.push({
                    i: i,
                    percentage: percentFullTime,
                    grossIncome: currentIncome,
                    workDays: actualWorkDays,
                    holidays: actualHolidays,
                    netWorkingDays: netWorkingDays,
                    noSippNet: noSippCalc.netIncome,
                    maxNet: maxNet,
                    
                    // Tax breakdown
                    noSippContrib: 0,
                    noSippTax: noSippCalc.incomeTax,
                    noSippNI: noSippCalc.nationalInsurance,
                    maxSipp: maxPension,
                    maxTax: maxSippCalc.incomeTax,
                    maxNI: maxSippCalc.nationalInsurance
                });
            }
            
            // Now calculate MNO for each step (marginal rate between consecutive steps)
            for (let i = 1; i <= 20; i++) {
                const current = rawData[i];
                const previous = rawData[i-1];
                
                // Calculate Œî NO and additional working days for this step
                const noSippDeltaNO = current.noSippNet - previous.noSippNet;
                const maxDeltaNO = current.maxNet - previous.maxNet;
                const additionalWorkingDays = current.netWorkingDays - previous.netWorkingDays;
                
                // Calculate MNO = Œî NO √∑ additional working days for this step
                const mnoNoSipp = additionalWorkingDays > 0 ? noSippDeltaNO / additionalWorkingDays : 0;
                const mnoMax = additionalWorkingDays > 0 ? maxDeltaNO / additionalWorkingDays : 0;
                
                data.push({
                    ...current,
                    mnoNoSipp: mnoNoSipp,
                    mnoMax: mnoMax
                });
            }
            
            return data;
        }

        function updateChart() {
            const fullTimeIncome = parseInt(document.getElementById('grossIncome').value) || 50000;
            const carryoverSipp = parseInt(document.getElementById('carryoverSipp').value) || 0;
            
            // Calculate shared data once
            sharedData = calculateSharedData(fullTimeIncome, carryoverSipp);
            
            // Extract chart data from shared data
            const partTimeData = sharedData.map(d => d.percentage);
            const noSippRates = sharedData.map(d => d.mnoNoSipp);
            const maxSippRates = sharedData.map(d => d.mnoMax);
            
            const chartDom = document.getElementById('efficiencyChart');
            if (!efficiencyChart) {
                efficiencyChart = echarts.init(chartDom);
            }
            
            const series = [
                {
                    name: 'No SIPP',
                    data: noSippRates,
                    type: 'line',
                    step: 'end',
                    lineStyle: { width: 3 },
                    itemStyle: { color: '#e74c3c' },
                    markPoint: {
                        data: [{ type: 'max', name: 'Peak Rate' }],
                        label: {
                            formatter: function(param) {
                                return `¬£${Math.round(param.value)}`;
                            }
                        }
                    }
                },
                {
                    name: carryoverSipp > 0 ? `Max SIPP (+¬£${carryoverSipp.toLocaleString()} carryover)` : 'Max SIPP (¬£60k allowance)',
                    data: maxSippRates,
                    type: 'line',
                    step: 'end',
                    lineStyle: { width: 3 },
                    itemStyle: { color: '#2ecc71' },
                    markPoint: {
                        data: [{ type: 'max', name: 'Peak Rate' }],
                        label: {
                            formatter: function(param) {
                                return `¬£${Math.round(param.value)}`;
                            }
                        }
                    }
                }
            ];
            
            const option = {
                title: {
                    text: `¬£${fullTimeIncome.toLocaleString()} Full-Time Salary`,
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis',
                    formatter: function(params) {
                        const percent = params[0].axisValue;
                        const dataIndex = params[0].dataIndex;
                        const grossIncome = sharedData[dataIndex].grossIncome;
                        let result = `Working ${percent} of full time<br>`;
                        result += `Gross Income: ¬£${Math.round(grossIncome).toLocaleString()}<br>`;
                        params.forEach(param => {
                            result += `${param.seriesName}: ¬£${Math.round(param.value)} NO per day<br>`;
                        });
                        return result;
                    }
                },
                legend: {
                    data: series.map(s => s.name),
                    bottom: 5
                },
                xAxis: {
                    type: 'category',
                    data: partTimeData.map(p => `${p}%`),
                    name: '% of Full Time',
                    nameLocation: 'center',
                    nameGap: 30
                },
                yAxis: {
                    type: 'value',
                    name: 'Marginal Net Outcome per Working Day (¬£)',
                    nameRotate: 90,
                    nameLocation: 'middle',
                    nameGap: 50,
                    axisLabel: {
                        formatter: function(value) {
                            return `¬£${Math.round(value)}`;
                        }
                    }
                },
                series: series,
                grid: {
                    left: '10%',
                    right: '10%',
                    bottom: '15%',
                    top: '15%'
                }
            };
            
            efficiencyChart.setOption(option);
            
            // Generate marginal tax rate chart (static background info)
            generateMarginalTaxChart();
            
            // Generate breakdown table
            generateBreakdownTable(fullTimeIncome, carryoverSipp);
        }

        function generateMarginalTaxChart() {
            const incomes = [];
            const incomeTaxRates = [];
            const niRates = [];
            const combinedRates = [];
            const sippEffectiveRates = [];
            const sippEffectiveRatesWithCarryover = [];
            
            const carryoverSipp = parseInt(document.getElementById('carryoverSipp').value) || 0;
            
            // Calculate marginal rates from ¬£0 to ¬£500k
            for (let income = 0; income <= 500000; income += 2500) {
                incomes.push(income);
                
                // Calculate marginal rates using small increment
                const increment = 100;
                
                // Basic rates (no pension)
                const current = calculateTotalTax(income, 0);
                const higher = calculateTotalTax(income + increment, 0);
                
                const marginalIncomeTax = ((higher.incomeTax - current.incomeTax) / increment) * 100;
                const marginalNI = ((higher.nationalInsurance - current.nationalInsurance) / increment) * 100;
                const marginalCombined = marginalIncomeTax + marginalNI;
                
                // SIPP scenario rates (with pension optimization)
                const currentMaxPension = calculateMaxPensionContribution(income, 0);
                const higherMaxPension = calculateMaxPensionContribution(income + increment, 0);
                const currentSippCalc = calculateTotalTax(income, currentMaxPension);
                const higherSippCalc = calculateTotalTax(income + increment, higherMaxPension);
                const currentSippNet = currentSippCalc.netIncome + currentMaxPension;
                const higherSippNet = higherSippCalc.netIncome + higherMaxPension;
                
                // Effective marginal rate = 1 - (additional net income / additional gross income)
                const sippEffectiveRate = (1 - ((higherSippNet - currentSippNet) / increment)) * 100;
                
                // SIPP scenario with carryover
                const currentMaxPensionCarryover = calculateMaxPensionContribution(income, carryoverSipp);
                const higherMaxPensionCarryover = calculateMaxPensionContribution(income + increment, carryoverSipp);
                const currentSippCarryoverCalc = calculateTotalTax(income, currentMaxPensionCarryover);
                const higherSippCarryoverCalc = calculateTotalTax(income + increment, higherMaxPensionCarryover);
                const currentSippCarryoverNet = currentSippCarryoverCalc.netIncome + currentMaxPensionCarryover;
                const higherSippCarryoverNet = higherSippCarryoverCalc.netIncome + higherMaxPensionCarryover;
                
                const sippEffectiveRateCarryover = (1 - ((higherSippCarryoverNet - currentSippCarryoverNet) / increment)) * 100;
                
                incomeTaxRates.push(marginalIncomeTax);
                niRates.push(marginalNI);
                combinedRates.push(marginalCombined);
                sippEffectiveRates.push(sippEffectiveRate);
                sippEffectiveRatesWithCarryover.push(sippEffectiveRateCarryover);
            }
            
            const chartDom = document.getElementById('marginalTaxChart');
            if (!marginalTaxChart) {
                marginalTaxChart = echarts.init(chartDom);
            }
            
            const option = {
                title: {
                    text: 'Marginal Tax Rates up to ¬£500k',
                    left: 'center',
                    textStyle: { fontSize: 14 }
                },
                tooltip: {
                    trigger: 'axis',
                    formatter: function(params) {
                        const incomeIndex = params[0].dataIndex;
                        const income = incomes[incomeIndex];
                        let result = `Income: ¬£${income.toLocaleString()}<br>`;
                        params.forEach(param => {
                            result += `${param.seriesName}: ${param.value.toFixed(1)}%<br>`;
                        });
                        return result;
                    }
                },
                legend: {
                    data: ['Income Tax', 'National Insurance', 'Combined', 'Max SIPP (¬£60k)', carryoverSipp > 0 ? 'Max SIPP (+Carryover)' : null].filter(Boolean),
                    bottom: 5
                },
                xAxis: {
                    type: 'category',
                    data: incomes.map(i => i.toLocaleString()),
                    axisLabel: {
                        formatter: function(value, index) {
                            return index % 40 === 0 ? `¬£${(incomes[index] / 1000).toFixed(0)}k` : '';
                        }
                    },
                    name: 'Gross Income',
                    nameLocation: 'center',
                    nameGap: 30
                },
                yAxis: {
                    type: 'value',
                    name: 'Marginal Rate (%)',
                    min: 0,
                    max: 100,
                    axisLabel: {
                        formatter: function(value) {
                            return `${value}%`;
                        }
                    }
                },
                series: [
                    {
                        name: 'Income Tax',
                        data: incomeTaxRates,
                        type: 'line',
                        step: 'end',
                        lineStyle: { width: 2 },
                        itemStyle: { color: '#e74c3c' }
                    },
                    {
                        name: 'National Insurance',
                        data: niRates,
                        type: 'line',
                        step: 'end',
                        lineStyle: { width: 2 },
                        itemStyle: { color: '#f39c12' }
                    },
                    {
                        name: 'Combined',
                        data: combinedRates,
                        type: 'line',
                        step: 'end',
                        lineStyle: { width: 3 },
                        itemStyle: { color: '#2c3e50' }
                    },
                    {
                        name: 'Max SIPP (¬£60k)',
                        data: sippEffectiveRates,
                        type: 'line',
                        step: 'end',
                        lineStyle: { width: 2, type: 'dashed' },
                        itemStyle: { color: '#27ae60' }
                    }
                ].concat(carryoverSipp > 0 ? [{
                    name: 'Max SIPP (+Carryover)',
                    data: sippEffectiveRatesWithCarryover,
                    type: 'line',
                    step: 'end',
                    lineStyle: { width: 2, type: 'dashed' },
                    itemStyle: { color: '#16a085' }
                }] : []),
                grid: {
                    left: '10%',
                    right: '10%',
                    bottom: '15%',
                    top: '15%'
                }
            };
            
            marginalTaxChart.setOption(option);
        }

        function generateBreakdownTable(fullTimeIncome, carryoverSipp) {
            const breakdownData = [];
            
            // Show ALL data points from the chart (all 20 points from 5% to 100%)
            for (let i = 0; i < sharedData.length; i++) {
                const dataPoint = sharedData[i];
                const prevDataPoint = i > 0 ? sharedData[i-1] : null;
                
                // Calculate Œî NO from previous step
                let noSippDeltaNO, maxDeltaNO;
                if (prevDataPoint) {
                    noSippDeltaNO = dataPoint.noSippNet - prevDataPoint.noSippNet;
                    maxDeltaNO = dataPoint.maxNet - prevDataPoint.maxNet;
                } else {
                    // First row - delta from 0
                    noSippDeltaNO = dataPoint.noSippNet;
                    maxDeltaNO = dataPoint.maxNet;
                }
                
                breakdownData.push({
                    percentage: `${Math.round(dataPoint.percentage)}%`,
                    grossIncome: dataPoint.grossIncome,
                    workDays: dataPoint.workDays,
                    holidays: dataPoint.holidays,
                    netWorkingDays: dataPoint.netWorkingDays,
                    
                    // No SIPP scenario
                    noSippContrib: dataPoint.noSippContrib,
                    noSippTax: dataPoint.noSippTax,
                    noSippNI: dataPoint.noSippNI,
                    noSippNet: dataPoint.noSippNet,
                    noSippDeltaNO: noSippDeltaNO,
                    noSippMNO: dataPoint.mnoNoSipp,
                    
                    // Max SIPP scenario
                    maxSipp: dataPoint.maxSipp,
                    maxTax: dataPoint.maxTax,
                    maxNI: dataPoint.maxNI,
                    maxNet: dataPoint.maxNet,
                    maxDeltaNO: maxDeltaNO,
                    maxMNO: dataPoint.mnoMax
                });
            }
            
            let tableHTML = `
                <table style="width: 100%; border-collapse: collapse; font-size: 10px; border: 1px solid #ddd;">
                    <thead>
                        <tr style="background: #f8f9fa;">
                            <th rowspan="2" style="border: 1px solid #ddd; padding: 3px; text-align: center;">%</th>
                            <th rowspan="2" style="border: 1px solid #ddd; padding: 3px; text-align: center;">Gross (¬£)</th>
                            <th rowspan="2" style="border: 1px solid #ddd; padding: 3px; text-align: center;">Work Days</th>
                            <th rowspan="2" style="border: 1px solid #ddd; padding: 3px; text-align: center;">Holidays</th>
                            <th rowspan="2" style="border: 1px solid #ddd; padding: 3px; text-align: center;">Net Work Days</th>
                            <th colspan="6" style="border: 1px solid #ddd; padding: 3px; background: #ffe6e6; text-align: center;">No SIPP (¬£0)</th>
                            <th colspan="6" style="border: 1px solid #ddd; padding: 3px; background: #e6ffe6; text-align: center;">Max SIPP</th>
                        </tr>
                        <tr style="background: #f8f9fa; font-size: 9px;">
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">SIPP (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">Tax (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">NI (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">NO (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">Œî NO (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; background: #ffcccc; font-weight: bold; text-align: center;">MNO (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">SIPP (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">Tax (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">NI (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">NO (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; text-align: center;">Œî NO (¬£)</th>
                            <th style="border: 1px solid #ddd; padding: 2px; background: #ccffcc; font-weight: bold; text-align: center;">MNO (¬£)</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            breakdownData.forEach(row => {
                tableHTML += `
                    <tr style="font-size: 9px;">
                        <td style="border: 1px solid #ddd; padding: 2px; font-weight: bold; text-align: center;">${row.percentage}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.grossIncome).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${row.workDays.toFixed(1)}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${row.holidays.toFixed(1)}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${row.netWorkingDays.toFixed(1)}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.noSippContrib).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.noSippTax).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.noSippNI).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.noSippNet).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.noSippDeltaNO).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; background: #ffcccc; font-weight: bold; text-align: right;">${Math.round(row.noSippMNO)}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.maxSipp).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.maxTax).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.maxNI).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.maxNet).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; text-align: right;">${Math.round(row.maxDeltaNO).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 2px; background: #ccffcc; font-weight: bold; text-align: right;">${Math.round(row.maxMNO)}</td>
                    </tr>
                `;
            });
            
            tableHTML += '</tbody></table>';
            
            document.getElementById('tableContent').innerHTML = tableHTML;
            document.getElementById('breakdownTable').style.display = 'block';
        }

        function setExample(salary) {
            document.getElementById('grossIncome').value = salary;
            // Keep existing carryover value unchanged
            updateChart();
        }

        document.addEventListener('DOMContentLoaded', function() {
            updateChart();
        });

        window.addEventListener('resize', function() {
            if (efficiencyChart) efficiencyChart.resize();
            if (marginalTaxChart) marginalTaxChart.resize();
        });
    </script>
</body>
</html>
