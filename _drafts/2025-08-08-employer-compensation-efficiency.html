---
layout: post
title: "ROI, Income Tax and MEE"
description: "Calculate the marginal net-to-gross ratio: how much worker net outcome you deliver per £1 of total employer expenditure (including employer NI)."
excerpt: "Understanding employer compensation efficiency through marginal net-to-gross ratios across different spending levels."
tags: [UK, tax, employer, efficiency, marginal-cost, SIPP, 2025-26]
categories: [vibecoding]
date: 2025-08-08
---

<div style="background: #fff5f5; border-left: 4px solid #e53e3e; padding: 12px; margin: 20px 0; border-radius: 4px;">
    <strong>Disclaimer:</strong> <span style="color: #e53e3e;">
        Nothing has been checked really. Could be quite wrong in the details.
    </span>
</div>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marginal Net-to-Gross</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>

        h1, h2, h3 {
            color: #2c3e50;
        }

        .calculator-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }

        .input-group {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        label {
            font-weight: 600;
            color: #34495e;
            min-width: 200px;
        }

        input {
            padding: 10px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
            width: 150px;
        }

        input:focus {
            outline: none;
            border-color: #3498db;
        }

        button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.3);
        }

        .chart {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin: 30px 0;
        }

        .chart-wrapper {
            width: 100%;
            height: 500px;
        }

        .examples-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 30px 0;
        }

        .example-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .example-btn {
            background: #e9ecef;
            color: #495057;
            border: 1px solid #ced4da;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .example-btn:hover {
            background: #dee2e6;
            transform: none;
            box-shadow: none;
        }

        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
                align-items: flex-start;
            }

            label {
                min-width: unset;
            }
        }
    </style>
</head>
<body>
    <h1>Net-to-Gross</h1>

    Consider spending associated with employing one human in the UK.

    <div style="background: #f8f9fa; border: 2px solid #3498db; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center;">
        <div style="font-size: 18px; font-weight: bold; color: #2c3e50;">
            <span style="color: #3498db;">Employee Net Outcome (NO)</span> = Take-Home Pay + Pension Contribution
        </div>
        <div style="font-size: 14px; color: #7f8c8d; margin-top: 8px;">
            (what the worker actually receives: salary minus taxes plus pension)
        </div>
    </div>

    <div style="background: #fff3e0; border: 2px solid #f39c12; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center;">
        <div style="font-size: 18px; font-weight: bold; color: #2c3e50;">
            <span style="color: #f39c12;">Employer Expenditure (EE)</span> = Gross Salary + Employer NI + Employer Pension
        </div>
        <div style="font-size: 14px; color: #7f8c8d; margin-top: 8px;">
            (your true cost including all employer contributions)
        </div>
    </div>

    <div style="background: #e8f5e8; border: 2px solid #27ae60; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center;">
        <div style="font-size: 18px; font-weight: bold; color: #2c3e50;">
            <span style="color: #27ae60;">Marginal Employment Efficiency (MEE)</span> = Δ NO / Δ EE
        </div>
        <div style="font-size: 14px; color: #7f8c8d; margin-top: 8px;">
            (how much extra net outcome the employee gets per additional £1 you spend)
        </div>
    </div>


    <p>
        What does the marginal net-to-gross ratio look like as we pay employees more through the year (the number of
        hours worked is irrelevant)?
    </p>

    <div class="calculator-container">
        <div class="input-group">
            <label for="carryoverSipp">Carry-Over Pension Allowance (£):</label>
            <input type="number" id="carryoverSipp" value="0" min="0" max="180000" step="1000">
        </div>

        <button onclick="updateChart()">Calculate Marginal Efficiency</button>
    </div>

    <div class="examples-container">
        <div class="example-buttons">
            <button class="example-btn" onclick="setCarryoverExample(0)">£0 Carryover</button>
            <button class="example-btn" onclick="setCarryoverExample(60000)">£60k Carryover</button>
            <button class="example-btn" onclick="setCarryoverExample(120000)">£120k Carryover</button>
            <button class="example-btn" onclick="setCarryoverExample(180000)">£180k Carryover</button>
        </div>
    </div>

    <div class="chart">
        <h3>Marginal Net-to-Gross Ratio</h3>
        <div id="efficiencyChart" class="chart-wrapper"></div>
    </div>

    <div id="breakdownTable" class="calculator-container" style="display: none;">
        <h3>Employer Expenditure Efficiency Breakdown</h3>
        <div id="tableContent"></div>
    </div>

    <script>
        const taxData2025 = {
            incomeTax: {
                personalAllowance: 12570,
                personalAllowanceReductionStart: 100000,
                personalAllowanceReductionRate: 0.5,
                bands: [
                    { min: 12570, max: 50270, rate: 0.20, name: "Basic Rate" },
                    { min: 50270, max: 125140, rate: 0.40, name: "Higher Rate" },
                    { min: 125140, max: Infinity, rate: 0.45, name: "Additional Rate" }
                ]
            },
            nationalInsurance: {
                rates: [
                    { min: 0, max: 12570, rate: 0.00 },
                    { min: 12570, max: 50284, rate: 0.08 },
                    { min: 50284, max: Infinity, rate: 0.02 }
                ]
            },
            employerNI: {
                threshold: 12570,
                rate: 0.138 // 13.8%
            },
            pension: {
                annualAllowance: 60000,
                minimumContribution: 3600,
                taperedAllowanceStart: 260000,
                taperedAllowanceMinimum: 10000,
                taperedRate: 0.5
            }
        };

        function calculatePersonalAllowance(grossIncome) {
            if (grossIncome <= taxData2025.incomeTax.personalAllowanceReductionStart) {
                return taxData2025.incomeTax.personalAllowance;
            }

            const reduction = (grossIncome - taxData2025.incomeTax.personalAllowanceReductionStart) *
                             taxData2025.incomeTax.personalAllowanceReductionRate;
            return Math.max(0, taxData2025.incomeTax.personalAllowance - reduction);
        }

        function calculateIncomeTax(grossIncome, pensionContribution = 0) {
            const taxableIncome = Math.max(0, grossIncome - pensionContribution);
            const personalAllowance = calculatePersonalAllowance(taxableIncome);
            const taxableAmount = Math.max(0, taxableIncome - personalAllowance);

            let tax = 0;
            for (const band of taxData2025.incomeTax.bands) {
                if (taxableAmount > band.min) {
                    const taxableInBand = Math.min(taxableAmount, band.max) - band.min;
                    tax += taxableInBand * band.rate;
                }
            }

            return tax;
        }

        function calculateNationalInsurance(grossIncome, pensionContribution = 0) {
            const niableIncome = Math.max(0, grossIncome - pensionContribution);
            let ni = 0;

            for (const band of taxData2025.nationalInsurance.rates) {
                if (niableIncome > band.min) {
                    const niableInBand = Math.min(niableIncome, band.max) - band.min;
                    ni += niableInBand * band.rate;
                }
            }

            return ni;
        }

        function calculateEmployerNI(grossIncome) {
            if (grossIncome <= taxData2025.employerNI.threshold) return 0;
            return (grossIncome - taxData2025.employerNI.threshold) * taxData2025.employerNI.rate;
        }

        function calculateMinimumEmployerPension(grossIncome) {
            // Auto-enrollment: 3% of qualifying earnings (£6,240 to £50,270)
            const qualifyingEarningsLower = 6240;
            const qualifyingEarningsUpper = 50270;
            const employerMinRate = 0.03;
            
            if (grossIncome <= qualifyingEarningsLower) return 0;
            
            const qualifyingEarnings = Math.min(grossIncome, qualifyingEarningsUpper) - qualifyingEarningsLower;
            return Math.max(0, qualifyingEarnings * employerMinRate);
        }

        function calculateMaxPensionContribution(grossIncome, carryoverAllowance = 0) {
            let allowance = taxData2025.pension.annualAllowance + carryoverAllowance;

            if (grossIncome > taxData2025.pension.taperedAllowanceStart) {
                const reduction = (grossIncome - taxData2025.pension.taperedAllowanceStart) *
                                 taxData2025.pension.taperedRate;
                allowance = Math.max(taxData2025.pension.taperedAllowanceMinimum, allowance - reduction);
            }

            return Math.min(allowance, Math.max(grossIncome, taxData2025.pension.minimumContribution));
        }

        function calculateTotalTax(grossIncome, pensionContribution = 0) {
            const incomeTax = calculateIncomeTax(grossIncome, pensionContribution);
            const nationalInsurance = calculateNationalInsurance(grossIncome, pensionContribution);

            return {
                incomeTax,
                nationalInsurance,
                total: incomeTax + nationalInsurance,
                netIncome: grossIncome - incomeTax - nationalInsurance - pensionContribution
            };
        }

        let efficiencyChart;
        let sharedData = []; // Single source of truth for both chart and table

        function calculateSharedData(carryoverSipp) {
            const data = [];

            // Use standard gross salary levels from £20k to £500k
            const salaryLevels = [];
            for (let salary = 20000; salary <= 500000; salary += 6000) {
                salaryLevels.push(salary);
            }

            salaryLevels.forEach((grossSalary, i) => {
                // Calculate employer costs
                const employerNI = calculateEmployerNI(grossSalary);
                const minEmployerPension = calculateMinimumEmployerPension(grossSalary);
                const totalEmployerSpend = grossSalary + employerNI + minEmployerPension;
                
                // Scenario 1: Minimum Employee Pension (£0)
                const noEmpPension = 0;
                const noEmpPensionCalc = calculateTotalTax(grossSalary, noEmpPension);
                const noEmpPensionTotalPension = minEmployerPension + noEmpPension;
                const noEmpPensionOutcome = noEmpPensionCalc.netIncome + noEmpPensionTotalPension;
                
                // Scenario 2: Maximum Employee Pension
                const maxAllowanceTotal = calculateMaxPensionContribution(grossSalary, carryoverSipp);
                const maxEmployeePension = Math.max(0, maxAllowanceTotal - minEmployerPension);
                const maxEmpPensionCalc = calculateTotalTax(grossSalary, maxEmployeePension);
                const maxEmpPensionTotalPension = minEmployerPension + maxEmployeePension;
                const maxEmpPensionOutcome = maxEmpPensionCalc.netIncome + maxEmpPensionTotalPension;
                
                data.push({
                    i: i,
                    grossSalary: grossSalary,
                    employerNI: employerNI,
                    minEmployerPension: minEmployerPension,
                    totalSpend: totalEmployerSpend,
                    
                    // No Employee Pension scenario
                    noEmpPension: noEmpPension,
                    noEmpPensionTax: noEmpPensionCalc.incomeTax,
                    noEmpPensionNI: noEmpPensionCalc.nationalInsurance,
                    noEmpPensionTakeHome: noEmpPensionCalc.netIncome,
                    noEmpPensionOutcome: noEmpPensionOutcome,
                    
                    // Max Employee Pension scenario
                    maxEmpPension: maxEmployeePension,
                    maxEmpPensionTax: maxEmpPensionCalc.incomeTax,
                    maxEmpPensionNI: maxEmpPensionCalc.nationalInsurance,
                    maxEmpPensionTakeHome: maxEmpPensionCalc.netIncome,
                    maxEmpPensionOutcome: maxEmpPensionOutcome
                });
            });

            // Calculate marginal efficiency for each step
            const processedData = [];
            for (let i = 1; i < data.length; i++) {
                const current = data[i];
                const previous = data[i-1];
                
                const additionalSpend = current.totalSpend - previous.totalSpend;
                
                // Marginal efficiency for No Employee Pension scenario
                const additionalOutcomeNoEmp = current.noEmpPensionOutcome - previous.noEmpPensionOutcome;
                const marginalEfficiencyNoEmp = additionalSpend > 0 ? additionalOutcomeNoEmp / additionalSpend : 0;
                
                // Marginal efficiency for Max Employee Pension scenario
                const additionalOutcomeMaxEmp = current.maxEmpPensionOutcome - previous.maxEmpPensionOutcome;
                const marginalEfficiencyMaxEmp = additionalSpend > 0 ? additionalOutcomeMaxEmp / additionalSpend : 0;
                
                processedData.push({
                    ...current,
                    marginalEfficiencyNoEmp: marginalEfficiencyNoEmp,
                    marginalEfficiencyMaxEmp: marginalEfficiencyMaxEmp
                });
            }

            return processedData;
        }

        function updateChart() {
            const carryoverSipp = parseInt(document.getElementById('carryoverSipp').value) || 0;

            // Calculate shared data once
            sharedData = calculateSharedData(carryoverSipp);
            console.log('SharedData sample:', sharedData.slice(0, 3)); // Debug

            // Extract chart data from shared data
            const employerCosts = sharedData.map(d => d.totalSpend);
            const marginalEfficienciesNoEmp = sharedData.map(d => (d.marginalEfficiencyNoEmp || 0)); // Keep as decimal
            const marginalEfficienciesMaxEmp = sharedData.map(d => (d.marginalEfficiencyMaxEmp || 0)); // Keep as decimal

            console.log('Marginal efficiencies NoEmp:', marginalEfficienciesNoEmp.slice(0, 5)); // Debug
            console.log('Marginal efficiencies MaxEmp:', marginalEfficienciesMaxEmp.slice(0, 5)); // Debug

            const chartDom = document.getElementById('efficiencyChart');
            if (!efficiencyChart) {
                efficiencyChart = echarts.init(chartDom);
            }

            const series = [
                {
                    name: 'No Employee Pension',
                    data: marginalEfficienciesNoEmp,
                    type: 'line',
                    step: 'end',
                    lineStyle: { width: 3 },
                    itemStyle: { color: '#e74c3c' },
                    markPoint: {
                        data: [{ type: 'max', name: 'Peak Efficiency' }],
                        label: {
                            formatter: function(param) {
                                return param.value.toFixed(2);
                            }
                        }
                    }
                },
                {
                    name: carryoverSipp > 0 ? `Max Employee Pension (+£${carryoverSipp.toLocaleString()} carryover)` : 'Max Employee Pension (£60k allowance)',
                    data: marginalEfficienciesMaxEmp,
                    type: 'line',
                    step: 'end',
                    lineStyle: { width: 3 },
                    itemStyle: { color: '#2ecc71' },
                    markPoint: {
                        data: [{ type: 'max', name: 'Peak Efficiency' }],
                        label: {
                            formatter: function(param) {
                                return param.value.toFixed(2);
                            }
                        }
                    }
                }
            ];

            const option = {
                title: {
                    text: carryoverSipp > 0 ? `With £${carryoverSipp.toLocaleString()} Pension Carryover` : 'Standard £60k Pension Allowance',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis',
                    formatter: function(params) {
                        const costIndex = params[0].dataIndex;
                        const cost = employerCosts[costIndex];
                        let result = `Employer Expenditure: £${cost.toLocaleString()}<br>`;
                        params.forEach(param => {
                            const dataPoint = sharedData[costIndex];
                            if (param.seriesName.includes('No Employee')) {
                                result += `${param.seriesName}: ${param.value.toFixed(2)} per £1<br>`;
                                result += `Gross Salary: £${dataPoint.grossSalary.toLocaleString()}<br>`;
                                result += `Employee Net Outcome: £${Math.round(dataPoint.noEmpPensionOutcome).toLocaleString()}<br>`;
                            } else {
                                result += `${param.seriesName}: ${param.value.toFixed(2)} per £1<br>`;
                                result += `Gross Salary: £${dataPoint.grossSalary.toLocaleString()}<br>`;
                                result += `Employee Net Outcome: £${Math.round(dataPoint.maxEmpPensionOutcome).toLocaleString()}<br>`;
                            }
                        });
                        return result;
                    }
                },
                legend: {
                    data: series.map(s => s.name),
                    bottom: 5
                },
                xAxis: {
                    type: 'category',
                    data: employerCosts.map(c => c.toLocaleString()),
                    axisLabel: {
                        formatter: function(value, index) {
                            return index % 10 === 0 ? `£${(employerCosts[index] / 1000).toFixed(0)}k` : '';
                        }
                    },
                    name: 'Total Employer Expenditure',
                    nameLocation: 'center',
                    nameGap: 30
                },
                yAxis: {
                    type: 'value',
                    name: 'Marginal Net-to-Gross Ratio',
                    nameRotate: 90,
                    nameLocation: 'middle',
                    nameGap: 50,
                    min: 0,
                    max: 1,
                    axisLabel: {
                        formatter: function(value) {
                            return value.toFixed(2);
                        }
                    }
                },
                series: series,
                grid: {
                    left: '15%',
                    right: '10%',
                    bottom: '15%',
                    top: '15%'
                }
            };

            efficiencyChart.setOption(option);

            // Generate breakdown table
            generateBreakdownTable(carryoverSipp);
        }

        function generateBreakdownTable(carryoverSipp) {
            const breakdownData = [];

            // Show every 10th data point to keep table manageable (given larger range)
            for (let i = 0; i < sharedData.length; i += 10) {
                const dataPoint = sharedData[i];
                
                breakdownData.push({
                    employerCost: dataPoint.totalSpend,
                    
                    // No Employee Pension scenario
                    noSippSalary: dataPoint.grossSalary,
                    noSippEmployerNI: dataPoint.employerNI,
                    noSippEmployerPension: dataPoint.minEmployerPension,
                    noSippEmployeePension: dataPoint.noEmpPension,
                    noSippTax: dataPoint.noEmpPensionTax,
                    noSippNI: dataPoint.noEmpPensionNI,
                    noSippTakeHome: dataPoint.noEmpPensionTakeHome,
                    noSippOutcome: dataPoint.noEmpPensionOutcome,
                    noSippMarginalEff: (dataPoint.marginalEfficiencyNoEmp || 0),
                    
                    // Max Employee Pension scenario
                    maxSippSalary: dataPoint.grossSalary,
                    maxSippEmployerNI: dataPoint.employerNI,
                    maxSippEmployerPension: dataPoint.minEmployerPension,
                    maxSippEmployeePension: dataPoint.maxEmpPension,
                    maxSippTax: dataPoint.maxEmpPensionTax,
                    maxSippNI: dataPoint.maxEmpPensionNI,
                    maxSippTakeHome: dataPoint.maxEmpPensionTakeHome,
                    maxSippOutcome: dataPoint.maxEmpPensionOutcome,
                    maxSippMarginalEff: (dataPoint.marginalEfficiencyMaxEmp || 0)
                });
            }

            // Create separate tables for clarity
            let tableHTML = `
                <h4 style="color: #e74c3c; margin-top: 30px;">Minimum Employee Pension (0)</h4>
                <table style="width: 100%; border-collapse: collapse; font-size: 11px; border: 1px solid #ddd; margin-bottom: 30px;">
                    <thead>
                        <tr style="background: #ffe6e6;">
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Total Spend</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Gross Salary</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Employer NI</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Employer Pension</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Income Tax</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Employee NI</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Employee Pension</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Total Pension</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Take-Home</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Net Outcome</th>
                            <th style="border: 1px solid #ddd; padding: 4px; background: #ffcccc; font-weight: bold; text-align: center;">MEE</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            // First table: No Employee Pension
            breakdownData.forEach(row => {
                const totalPension = row.noSippEmployerPension + row.noSippEmployeePension;
                tableHTML += `
                    <tr style="font-size: 10px;">
                        <td style="border: 1px solid #ddd; padding: 3px; font-weight: bold; text-align: center;">${Math.round(row.employerCost).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.noSippSalary).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.noSippEmployerNI).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.noSippEmployerPension).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.noSippTax).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.noSippNI).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.noSippEmployeePension).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right; font-weight: bold; color: #27ae60;">${Math.round(totalPension).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.noSippTakeHome).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right; font-weight: bold;">${Math.round(row.noSippOutcome).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; background: #ffcccc; font-weight: bold; text-align: right;">${row.noSippMarginalEff.toFixed(2)}</td>
                    </tr>
                `;
            });

            tableHTML += `
                    </tbody>
                </table>
                
                <h4 style="color: #27ae60; margin-top: 30px;">Maximum Employee Pension Contributions</h4>
                <table style="width: 100%; border-collapse: collapse; font-size: 11px; border: 1px solid #ddd;">
                    <thead>
                        <tr style="background: #e6ffe6;">
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Total Spend</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Gross Salary</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Employer NI</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Employer Pension</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Income Tax</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Employee NI</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Employee Pension</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Total Pension</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Take-Home</th>
                            <th style="border: 1px solid #ddd; padding: 4px; text-align: center;">Net Outcome</th>
                            <th style="border: 1px solid #ddd; padding: 4px; background: #ccffcc; font-weight: bold; text-align: center;">MEE</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            // Second table: Max Employee Pension
            breakdownData.forEach(row => {
                const totalPension = row.maxSippEmployerPension + row.maxSippEmployeePension;
                tableHTML += `
                    <tr style="font-size: 10px;">
                        <td style="border: 1px solid #ddd; padding: 3px; font-weight: bold; text-align: center;">${Math.round(row.employerCost).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.maxSippSalary).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.maxSippEmployerNI).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.maxSippEmployerPension).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.maxSippTax).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.maxSippNI).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.maxSippEmployeePension).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right; font-weight: bold; color: #27ae60;">${Math.round(totalPension).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right;">${Math.round(row.maxSippTakeHome).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; text-align: right; font-weight: bold;">${Math.round(row.maxSippOutcome).toLocaleString()}</td>
                        <td style="border: 1px solid #ddd; padding: 3px; background: #ccffcc; font-weight: bold; text-align: right;">${row.maxSippMarginalEff.toFixed(2)}</td>
                    </tr>
                `;
            });

            tableHTML += '</tbody></table>';

            document.getElementById('tableContent').innerHTML = tableHTML;
            document.getElementById('breakdownTable').style.display = 'block';
        }

        function setCarryoverExample(carryover) {
            document.getElementById('carryoverSipp').value = carryover;
            updateChart();
        }

        document.addEventListener('DOMContentLoaded', function() {
            updateChart();
        });

        window.addEventListener('resize', function() {
            if (efficiencyChart) efficiencyChart.resize();
        });
    </script>
</body>
</html>